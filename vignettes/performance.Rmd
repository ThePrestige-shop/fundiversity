---
title: "Performance comparison with other functional diversity packages"
output: rmarkdown::html_vignette
bibliography: performance.bib
vignette: >
  %\VignetteIndexEntry{Performance comparison with other functional diversity packages}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<!-- 
# Pre-render with 
knitr::knit("vignettes/_performance.Rmd", output = "vignettes/performance.Rmd")
-->



This vignette presents some performance tests ran between `fundiversity` and other functional diversity packages. Note that to avoid the dependency on other packages, this vignette is [**pre-computed**](https://ropensci.org/technotes/2019/12/08/precompute-vignettes/).

# Other packages to compute FD indices

## Main functions

**`FD::dbFD()`** is probably the most known function to compute functional diversity indices. It comes from the `FD` package proposed by @Laliberte_FD_2014. It can compute many indices: functional richness, Rao's quadratic entropy, community-weighted mean, functional divergence, functional dispersion, and functional group richness. This swiss-army knife of functional diversity indices has many options and compute several indices in a single run.

**`hillR::hill_func()`** comes from the `hillR` package that computes Hill numbers for taxonomic, functional, and functional diversity [@Li_hillR_2018]. It implements indices proposed by @Chao_Unifying_2014. It computes Rao's quadratic entropy, the mean functional diversity per species, as well as the total functional diversity.

**`adiv::QE()`** comes from the `adiv` package which proposes a toolkit to analyze biodiversity [@Pavoine_adiv_2020]. This function computes Rao's quadratic entropy.

**`SYNCSA::rao.diversity()`** comes from `SYNCSA` package which proposes a simulation framework for meta-communities [@Debastiani_SYNCSA_2012]. The function computes Rao's quadratic entropy as well as functional redundancy.

**`mFD::alpha.fd.hill()`** comes from the `mFD` package which offers a coherent framework to work with functional spaces and perform quality checks, diagnostic plots, as well as computing many functional diversity indiceS.

## Benchmark between packages

We will now benchmark the functions included in `fundiversity` with the corresponding function in other packages using the `microbenchmark::microbenchmark()` function.


```r
tictoc::tic()
library(fundiversity)
data("traits_birds", package = "fundiversity")
data("site_sp_birds", package = "fundiversity")

dist_traits_birds <- dist(traits_birds)
```

With the fairly small (~220 species, 8 sites, 4 traits) provided dataset in `fundiversity`:


```r
pkg_bench <- microbenchmark::microbenchmark(
  fundiversity = {
    fundiversity::fd_raoq(traits = NULL, site_sp_birds, dist_traits_birds)
  },
  adiv = {
    adiv::QE(site_sp_birds, dis = dist_traits_birds)
  },
  hillR = {
    hillR::hill_func(site_sp_birds, dist_traits_birds, traits_as_is = TRUE)[1, ]
  },
  SYNCSA = {
    SYNCSA::rao.diversity(site_sp_birds,
                          phylodist = as.matrix(dist_traits_birds),
                          standardize = FALSE)$PhyRao
  },
  FD = {
    suppressMessages(
      FD::dbFD(x = dist_traits_birds, a = site_sp_birds, stand.x = FALSE,
               calc.FRic = TRUE, calc.CWM = FALSE, calc.FDiv = FALSE,
               calc.FGR = FALSE, m = "max", stand.FRic = FALSE,
               messages = FALSE))
  },
  mFD = {
    mFD::alpha.fd.hill(site_sp_birds, dist_traits_birds, q = 2, tau = "max",
                       details_returned = FALSE)
  },
  times = 30
)

ggplot2::autoplot(pkg_bench)
```

![Performance comparison in computing Rao's quadratic entropy between `fundiversity` and other packages](fd-bench-data-rao-1.png)

```r
pkg_bench
#> Unit: milliseconds
#>          expr         min         lq        mean      median          uq        max neval cld
#>  fundiversity    2.224010    2.37701    4.781452    2.576993    2.733911   36.54022    30  a 
#>          adiv   14.405726   15.76062  334.895718   37.288465   42.246072 9110.68939    30  a 
#>         hillR   20.631983   21.97200   30.867960   24.890381   35.688186   75.83383    30  a 
#>        SYNCSA   99.990214  104.69245  183.905136  115.724078  138.383360 1984.58615    30  a 
#>            FD 3771.813313 3828.84571 3956.682356 3864.328405 3927.204354 4747.20277    30   b
#>           mFD    4.329188    4.54392   30.262538    4.814327    8.580099  608.34751    30  a
```


# Benchmark within `fundiversity`

We now proceed to the performance evaluation of functions within `fundiversity` with datasets of increasing sizes.

## Increasing the number of species


```r
make_more_sp <- function(n) {
  traits <- do.call(rbind, replicate(n, traits_birds, simplify = FALSE))
  row.names(traits) <- paste0("sp", seq_len(nrow(traits)))

  site_sp <- do.call(cbind, replicate(n, site_sp_birds, simplify = FALSE))
  colnames(site_sp) <- paste0("sp", seq_len(ncol(site_sp)))

  list(tr = traits, si = site_sp)
}

null_sp_1000   <- make_more_sp(5)
null_sp_10000  <- make_more_sp(50)
null_sp_100000 <- make_more_sp(500)
```

### Functional Richness


```r
bench_sp_fric <- microbenchmark::microbenchmark(
  species_200    = fd_fric(     traits_birds, site_sp_birds),
  species_1000   = fd_fric(  null_sp_1000$tr, null_sp_1000$si),
  species_10000  = fd_fric( null_sp_10000$tr, null_sp_10000$si),
  species_100000 = fd_fric(null_sp_100000$tr, null_sp_100000$si),
  times = 30
)

ggplot2::autoplot(bench_sp_fric)
```

![Performance comparison of `fd_fric()` with increasing number of species.](fd-bench-species-fric-1.png)

```r
bench_sp_fric
#> Unit: milliseconds
#>            expr        min         lq       mean     median          uq        max neval cld
#>     species_200   7.650253   7.781204   8.277942   7.927151    8.090287   17.68536    30  a 
#>    species_1000  12.855771  13.019348  13.497166  13.169401   13.308256   21.94092    30  a 
#>   species_10000  60.428101  61.053870  69.668975  61.367838   70.020126  100.16642    30  a 
#>  species_100000 605.250427 634.867698 859.636411 640.672487 1238.436013 1274.49016    30   b
```

### Functional Divergence


```r
bench_sp_fdiv <- microbenchmark::microbenchmark(
  species_200    = fd_fdiv(     traits_birds, site_sp_birds),
  species_1000   = fd_fdiv(  null_sp_1000$tr, null_sp_1000$si),
  species_10000  = fd_fdiv( null_sp_10000$tr, null_sp_10000$si),
  species_100000 = fd_fdiv(null_sp_100000$tr, null_sp_100000$si),
  times = 30
)

ggplot2::autoplot(bench_sp_fdiv)
```

![Performance comparison of `fd_fdiv()` with increasing number of species.](fd-bench-species-fdiv-1.png)

```r
bench_sp_fdiv
#> Unit: milliseconds
#>            expr        min         lq       mean     median         uq         max neval cld
#>     species_200   1.378985   1.449586   1.520754   1.476270   1.540299    1.997587    30  a 
#>    species_1000   2.371657   2.442248   7.857682   2.504424   2.592663  106.266946    30  a 
#>   species_10000  14.350122  14.528894  20.562872  14.759380  15.654314   43.841307    30  a 
#>  species_100000 235.021974 242.491736 404.008230 274.714110 312.833904 1002.580793    30   b
```

### Rao's Quadratric Entropy


```r
bench_sp_raoq <- microbenchmark::microbenchmark(
  species_200    = fd_raoq(     traits_birds, site_sp_birds),
  species_1000   = fd_raoq(  null_sp_1000$tr, null_sp_1000$si),
  species_10000  = fd_raoq( null_sp_10000$tr, null_sp_10000$si),
  times = 30
)

ggplot2::autoplot(bench_sp_raoq)
```

![Performance comparison of `fd_raoq()` with increasing number of species.](fd-bench-species-raoq-1.png)

```r
bench_sp_raoq
#> Unit: milliseconds
#>           expr          min         lq         mean       median           uq         max neval cld
#>    species_200     2.584048     2.6802     4.937107     2.847961     2.911515    64.91719    30  a 
#>   species_1000   124.567673   125.2026   127.076021   127.049932   129.071798   131.60577    30  a 
#>  species_10000 24237.048920 24368.7150 24706.156198 24456.227126 24825.978723 28198.97838    30   b
```

### Functional Evenness


```r
bench_sp_feve <- microbenchmark::microbenchmark(
  species_200    = fd_feve(     traits_birds, site_sp_birds),
  species_1000   = fd_feve(  null_sp_1000$tr, null_sp_1000$si),
  species_10000  = fd_feve( null_sp_10000$tr, null_sp_10000$si),
  times = 30
)

ggplot2::autoplot(bench_sp_feve)
```

![Performance comparison of `fd_feve()` with increasing number of species.](fd-bench-species-feve-1.png)

```r
bench_sp_feve
#> Unit: milliseconds
#>           expr         min          lq        mean      median          uq         max neval cld
#>    species_200    11.17215    11.44301    12.33728    11.79237    12.24989    20.59761    30  a 
#>   species_1000   197.85067   279.95442   280.47473   289.50154   297.68343   336.33779    30  a 
#>  species_10000 58136.53352 60618.48446 60999.92341 61352.07935 61751.75521 62372.93708    30   b
```

### Comparing between indices


```r
all_bench_sp <- list(fric = bench_sp_fric,
                     fdiv = bench_sp_fdiv,
                     raoq = bench_sp_raoq,
                     feve = bench_sp_feve) %>%
  bind_rows(.id = "fd_index") %>%
  mutate(n_sp = gsub("species_", "", expr) %>%
           as.numeric())

all_bench_sp %>%
  ggplot(aes(n_sp, time * 1e-9, color = fd_index)) +
  geom_point(alpha = 1/3) +
  geom_smooth() +
  scale_x_log10() +
  scale_y_log10() +
  scale_color_brewer(type = "qual",
                     labels = c(fric = "FRic", fdiv = "FDiv", raoq = "Rao's Q",
                                feve = "FEve")) +
  labs(title = "Performance comparison between indices",
       x = "# of species", y = "Time (in seconds)",
       color = "FD index") +
  theme_bw() +
  theme(aspect.ratio = 1)
```

![Performance comparison between functions for distinct indices in `fundiversity` with increasing number of species. Smoothed trend lines and standard error enveloppes ares shown.](fd-bench-species-compare-1.png)

## Increasing the number of sites


```r
make_more_sites <- function(n) {
  site_sp <- do.call(rbind, replicate(n, site_sp_birds, simplify = FALSE))
  rownames(site_sp) <- paste0("s", seq_len(nrow(site_sp)))

  site_sp
}

site_sp_100   <- make_more_sites(12)
site_sp_1000  <- make_more_sites(120)
site_sp_10000 <- make_more_sites(1200)
```


### Functional Richness


```r
bench_sites_fric = microbenchmark::microbenchmark(
  sites_10    = fd_fric(traits_birds, site_sp_birds),
  sites_100   = fd_fric(traits_birds, site_sp_100),
  sites_1000  = fd_fric(traits_birds, site_sp_1000),
  sites_10000 = fd_fric(traits_birds, site_sp_10000),
  times = 30
)

ggplot2::autoplot(bench_sites_fric)
```

![Performance comparison of `fd_fric()` with increasing number of sites.](fd-bench-sites-fric-1.png)

```r
bench_sites_fric
#> Unit: milliseconds
#>         expr         min          lq       mean      median          uq         max neval cld
#>     sites_10    7.607112    7.708243    7.91207    7.838421    7.979479    8.717983    30 a  
#>    sites_100   84.306860   85.384449   88.56248   86.235620   89.808674  103.375883    30 a  
#>   sites_1000  861.504150  869.061084  963.01446  879.534198 1027.562927 1781.083451    30  b 
#>  sites_10000 8957.169818 9128.823757 9301.94825 9289.273103 9469.840746 9618.792008    30   c
```

### Functional Divergence


```r
bench_sites_fdiv = microbenchmark::microbenchmark(
  sites_10    = fd_fdiv(traits_birds, site_sp_birds),
  sites_100   = fd_fdiv(traits_birds, site_sp_100),
  sites_1000  = fd_fdiv(traits_birds, site_sp_1000),
  sites_10000 = fd_fdiv(traits_birds, site_sp_10000),
  times = 30
)

ggplot2::autoplot(bench_sites_fdiv)
```

![Performance comparison of `fd_fdiv()` with increasing number of sites.](fd-bench-sites-fdiv-1.png)

```r
bench_sites_fdiv
#> Unit: milliseconds
#>         expr        min          lq       mean      median          uq         max neval cld
#>     sites_10   1.349320    1.436685    1.52522    1.488984    1.564456    2.287361    30 a  
#>    sites_100   9.250358    9.399126   10.12482    9.554886   10.497096   17.668815    30 a  
#>   sites_1000  87.895239   89.193585   97.83039   89.972217   92.344964  223.390052    30  b 
#>  sites_10000 984.327901 1003.257170 1031.25032 1019.222113 1028.779555 1326.922434    30   c
```

### Rao's Quadratic Entropy


```r
bench_sites_raoq = microbenchmark::microbenchmark(
  sites_10    = fd_raoq(traits = NULL, site_sp_birds, dist_traits_birds),
  sites_100   = fd_raoq(traits = NULL, site_sp_100,   dist_traits_birds),
  sites_1000  = fd_raoq(traits = NULL, site_sp_1000,  dist_traits_birds),
  sites_10000 = fd_raoq(traits = NULL, site_sp_10000, dist_traits_birds),
  times = 30
)

ggplot2::autoplot(bench_sites_raoq)
```

![Performance comparison of `fd_raoq()` with increasing number of sites.](fd-bench-sites-raoq-1.png)

```r
bench_sites_raoq
#> Unit: milliseconds
#>         expr        min         lq       mean     median          uq         max neval cld
#>     sites_10   2.373697   2.459257   2.755239   2.746818    2.863676    3.827474    30  a 
#>    sites_100   2.923065   3.267814   8.039443   3.610872   12.317832   21.612761    30  a 
#>   sites_1000  10.372173  11.424059  19.431384  12.926801   19.512558  133.624070    30  a 
#>  sites_10000 370.950321 486.812037 809.989892 623.394065 1152.882870 1305.509859    30   b
```

### Functional Evenness


```r
bench_sites_feve = microbenchmark::microbenchmark(
  sites_10    = fd_feve(traits = NULL, site_sp_birds, dist_traits_birds),
  sites_100   = fd_feve(traits = NULL, site_sp_100,   dist_traits_birds),
  sites_1000  = fd_feve(traits = NULL, site_sp_1000,  dist_traits_birds),
  sites_10000 = fd_feve(traits = NULL, site_sp_10000, dist_traits_birds),
  times = 30
)

ggplot2::autoplot(bench_sites_feve)
```

![Performance comparison of `fd_feve()` with increasing number of sites](fd-bench-sites-feve-1.png)

```r
bench_sites_feve
#> Unit: milliseconds
#>         expr         min         lq        mean      median          uq         max neval cld
#>     sites_10    10.80843    10.9630    11.37922    11.25525    11.50652    12.92798    30 a  
#>    sites_100   106.43742   110.3452   127.06238   114.31121   155.53173   178.59674    30 a  
#>   sites_1000  1140.43441  1162.3704  1238.24333  1199.50446  1237.75353  1828.14702    30  b 
#>  sites_10000 11485.65712 11673.7873 12425.01912 11894.73131 12839.05688 16022.25103    30   c
```


### Comparing between indices


```r
all_bench_sites <- list(fric = bench_sites_fric,
                        fdiv = bench_sites_fdiv,
                        raoq = bench_sites_raoq,
                        feve = bench_sites_feve) %>%
  bind_rows(.id = "fd_index") %>%
  mutate(n_sites = gsub("sites", "", expr) %>%
           as.numeric())

all_bench_sites %>%
  ggplot(aes(n_sites, time * 1e-9, color = fd_index)) +
  geom_point(alpha = 1/3) +
  geom_smooth() +
  scale_x_log10() +
  scale_y_log10() +
  scale_color_brewer(type = "qual",
                     labels = c(fric = "FRic", fdiv = "FDiv", raoq = "Rao's Q",
                                feve = "FEve")) +
  labs(title = "Performance comparison between indices",
       x = "# of sites", y = "Time (in seconds)",
       color = "FD index") +
  theme_bw() +
  theme(aspect.ratio = 1)
```

![Performance comparison between functions for distinct indices in `fundiversity` with increasing number of sites. Smoothed trend lines and standard error enveloppes ares shown.](fd-bench-sites-compare-1.png)

<details>
<summary>Session info of the machine on which the benchmark was ran and time it took to run</summary>


```
#>  seconds needed to generate this document: 3564.614 sec elapsed
#> ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────
#>  setting  value                       
#>  version  R version 3.6.3 (2020-02-29)
#>  os       Ubuntu 16.04.7 LTS          
#>  system   x86_64, linux-gnu           
#>  ui       RStudio                     
#>  language (EN)                        
#>  collate  en_US.UTF-8                 
#>  ctype    en_US.UTF-8                 
#>  tz       Europe/Berlin               
#>  date     2021-07-29                  
#> 
#> ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────
#>  !  package           * version    date       lib source                            
#>     abind               1.4-5      2016-07-21 [3] CRAN (R 3.5.0)                    
#>     ade4                1.7-17     2021-06-17 [1] CRAN (R 3.6.3)                    
#>     adegenet            2.1.3      2020-05-10 [1] CRAN (R 3.6.3)                    
#>     adegraphics         1.0-15     2018-12-18 [1] CRAN (R 3.6.3)                    
#>     adephylo            1.1-11     2017-12-18 [3] CRAN (R 3.5.0)                    
#>     adiv                2.0.1      2020-08-26 [1] CRAN (R 3.6.3)                    
#>     ape                 5.5        2021-04-25 [3] CRAN (R 3.6.3)                    
#>     assertthat          0.2.1      2019-03-21 [3] CRAN (R 3.5.3)                    
#>     boot                1.3-28     2021-05-03 [4] CRAN (R 3.6.3)                    
#>     callr               3.7.0      2021-04-20 [3] CRAN (R 3.6.3)                    
#>     class               7.3-19     2021-05-03 [4] CRAN (R 3.6.3)                    
#>     classInt            0.4-3      2020-04-07 [3] CRAN (R 3.6.3)                    
#>  VP cli                 2.5.0      2021-07-17 [3] CRAN (R 3.6.3)                    
#>     cluster             2.1.2      2021-04-17 [4] CRAN (R 3.6.3)                    
#>     clusterGeneration   1.3.7      2020-12-15 [3] CRAN (R 3.6.3)                    
#>     coda                0.19-4     2020-09-30 [3] CRAN (R 3.6.3)                    
#>     codetools           0.2-18     2020-11-04 [4] CRAN (R 3.6.3)                    
#>  VP colorspace          2.0-1      2021-06-24 [3] CRAN (R 3.6.3)                    
#>     combinat            0.0-8      2010-08-05 [3] CRAN (R 3.5.0)                    
#>     crayon              1.4.1      2021-02-08 [3] CRAN (R 3.6.3)                    
#>     crosstalk           1.1.1      2021-01-12 [3] CRAN (R 3.6.3)                    
#>  VP curl                4.3.1      2021-06-23 [3] CRAN (R 3.6.3)                    
#>     DBI                 1.1.1      2021-01-15 [3] CRAN (R 3.6.3)                    
#>     deldir              0.2-10     2021-02-16 [3] CRAN (R 3.6.3)                    
#>     digest              0.6.27     2020-10-24 [3] CRAN (R 3.6.3)                    
#>     dplyr             * 1.0.7      2021-06-18 [1] CRAN (R 3.6.3)                    
#>     DT                  0.18       2021-04-14 [3] CRAN (R 3.6.3)                    
#>     e1071               1.7-7      2021-05-23 [3] CRAN (R 3.6.3)                    
#>     ellipsis            0.3.2      2021-04-29 [3] CRAN (R 3.6.3)                    
#>     evaluate            0.14       2019-05-28 [3] CRAN (R 3.6.0)                    
#>     expm                0.999-6    2021-01-13 [3] CRAN (R 3.6.3)                    
#>     FactoMineR          2.4        2020-12-11 [3] CRAN (R 3.6.3)                    
#>     fansi               0.5.0      2021-05-25 [3] CRAN (R 3.6.3)                    
#>     farver              2.1.0      2021-02-28 [3] CRAN (R 3.6.3)                    
#>     fastmap             1.1.0      2021-01-25 [3] CRAN (R 3.6.3)                    
#>     fastmatch           1.1-3      2021-07-23 [1] CRAN (R 3.6.3)                    
#>     FD                  1.0-12     2014-08-19 [1] CRAN (R 3.6.3)                    
#>     flashClust          1.01-2     2012-08-21 [3] CRAN (R 3.5.0)                    
#>     fundiversity      * 0.0.0.9000 2021-01-22 [1] local                             
#>     gdata               2.18.0     2017-06-06 [3] CRAN (R 3.5.0)                    
#>     generics            0.1.0      2020-10-31 [3] CRAN (R 3.6.3)                    
#>     geometry            0.4.5      2019-12-04 [3] CRAN (R 3.6.1)                    
#>     ggplot2           * 3.3.5      2021-06-25 [1] CRAN (R 3.6.3)                    
#>     ggrepel             0.9.1      2021-01-15 [3] CRAN (R 3.6.3)                    
#>     glue                1.4.2      2020-08-27 [3] CRAN (R 3.6.3)                    
#>     gmodels             2.18.1     2018-06-25 [3] CRAN (R 3.5.0)                    
#>     gtable              0.3.0      2019-03-25 [3] CRAN (R 3.5.3)                    
#>     gtools              3.9.2      2021-06-06 [3] CRAN (R 3.6.3)                    
#>     highr               0.9        2021-04-16 [3] CRAN (R 3.6.3)                    
#>     hillR               0.5.0      2020-07-07 [1] CRAN (R 3.6.3)                    
#>     hms                 1.1.0      2021-05-17 [3] CRAN (R 3.6.3)                    
#>     htmltools           0.5.1.1    2021-01-22 [3] CRAN (R 3.6.3)                    
#>     htmlwidgets         1.5.3      2020-12-10 [3] CRAN (R 3.6.3)                    
#>     httpuv              1.6.1      2021-05-07 [3] CRAN (R 3.6.3)                    
#>     httr                1.4.2      2020-07-20 [3] CRAN (R 3.6.3)                    
#>     igraph              1.2.6      2020-10-06 [3] CRAN (R 3.6.3)                    
#>     jpeg                0.1-9      2021-07-24 [1] CRAN (R 3.6.3)                    
#>     jsonlite            1.7.2      2020-12-09 [3] CRAN (R 3.6.3)                    
#>     KernSmooth          2.23-20    2021-05-03 [4] CRAN (R 3.6.3)                    
#>     knitr               1.33       2021-04-24 [3] CRAN (R 3.6.3)                    
#>     later               1.2.0      2021-04-23 [3] CRAN (R 3.6.3)                    
#>     lattice             0.20-44    2021-05-02 [4] CRAN (R 3.6.3)                    
#>     latticeExtra        0.6-29     2019-12-19 [3] CRAN (R 3.6.2)                    
#>     lazyeval            0.2.2      2019-03-15 [3] CRAN (R 3.5.3)                    
#>     leaps               3.1        2020-01-16 [3] CRAN (R 3.6.2)                    
#>     LearnBayes          2.15.1     2018-03-18 [3] CRAN (R 3.5.0)                    
#>     lifecycle           1.0.0      2021-02-15 [3] CRAN (R 3.6.3)                    
#>     magic               1.5-9      2018-09-17 [3] CRAN (R 3.5.1)                    
#>     magrittr            2.0.1      2020-11-17 [3] CRAN (R 3.6.3)                    
#>     manipulateWidget    0.11.0     2021-05-31 [3] CRAN (R 3.6.3)                    
#>     maps                3.3.0      2018-04-03 [3] CRAN (R 3.5.0)                    
#>     MASS                7.3-54     2021-05-03 [4] CRAN (R 3.6.3)                    
#>     Matrix              1.3-4      2021-06-01 [4] CRAN (R 3.6.3)                    
#>     mFD                 1.0.0      2021-07-29 [1] Github (CmlMagneville/mFD@a6af567)
#>     mgcv                1.8-36     2021-06-01 [4] CRAN (R 3.6.3)                    
#>     microbenchmark      1.4-7      2019-09-24 [1] CRAN (R 3.6.3)                    
#>     mime                0.11       2021-06-23 [1] CRAN (R 3.6.3)                    
#>     miniUI              0.1.1.1    2018-05-18 [3] CRAN (R 3.5.0)                    
#>     mnormt              2.0.2      2020-09-01 [3] CRAN (R 3.6.3)                    
#>     multcomp            1.4-17     2021-04-29 [3] CRAN (R 3.6.3)                    
#>     munsell             0.5.0      2018-06-12 [3] CRAN (R 3.5.0)                    
#>     mvtnorm             1.1-2      2021-06-07 [3] CRAN (R 3.6.3)                    
#>     nlme                3.1-152    2021-02-04 [4] CRAN (R 3.6.3)                    
#>     numDeriv            2016.8-1.1 2019-06-06 [3] CRAN (R 3.6.0)                    
#>     patchwork           1.1.1      2020-12-17 [1] CRAN (R 3.6.3)                    
#>     permute             0.9-5      2019-03-12 [3] CRAN (R 3.5.3)                    
#>     phangorn            2.7.0      2021-05-03 [3] CRAN (R 3.6.3)                    
#>     phylobase           0.8.10     2020-03-01 [3] CRAN (R 3.6.3)                    
#>     phytools            0.7-80     2021-06-03 [3] CRAN (R 3.6.3)                    
#>  VP pillar              1.6.1      2021-07-29 [3] CRAN (R 3.6.3)                    
#>     pkgbuild            1.2.0      2020-12-15 [3] CRAN (R 3.6.3)                    
#>     pkgconfig           2.0.3      2019-09-22 [1] CRAN (R 3.6.3)                    
#>     plotrix             3.8-1      2021-01-21 [1] CRAN (R 3.6.3)                    
#>     plyr                1.8.6      2020-03-03 [3] CRAN (R 3.6.3)                    
#>     png                 0.1-7      2013-12-03 [3] CRAN (R 3.5.0)                    
#>     prettyunits         1.1.1      2020-01-24 [3] CRAN (R 3.6.2)                    
#>     processx            3.5.2      2021-04-30 [3] CRAN (R 3.6.3)                    
#>     progress            1.2.2      2019-05-16 [3] CRAN (R 3.6.0)                    
#>     promises            1.2.0.1    2021-02-11 [3] CRAN (R 3.6.3)                    
#>     proxy               0.4-26     2021-06-07 [3] CRAN (R 3.6.3)                    
#>     ps                  1.6.0      2021-02-28 [3] CRAN (R 3.6.3)                    
#>     purrr               0.3.4      2020-04-17 [3] CRAN (R 3.6.3)                    
#>     quadprog            1.5-8      2019-11-20 [3] CRAN (R 3.6.1)                    
#>     R6                  2.5.0      2020-10-28 [3] CRAN (R 3.6.3)                    
#>     raster              3.4-10     2021-05-03 [3] CRAN (R 3.6.3)                    
#>     RColorBrewer        1.1-2      2014-12-07 [3] CRAN (R 3.5.0)                    
#>     Rcpp                1.0.7      2021-07-07 [1] CRAN (R 3.6.3)                    
#>     RcppArmadillo       0.10.6.0.0 2021-07-16 [1] CRAN (R 3.6.3)                    
#>     remotes             2.4.0      2021-06-02 [3] CRAN (R 3.6.3)                    
#>     reshape2            1.4.4      2020-04-09 [3] CRAN (R 3.6.3)                    
#>     rgl                 0.104.16   2021-01-10 [1] CRAN (R 3.6.3)                    
#>     rlang               0.4.11     2021-04-30 [3] CRAN (R 3.6.3)                    
#>     rncl                0.8.4      2020-02-10 [3] CRAN (R 3.6.2)                    
#>     RNeXML              2.4.5      2020-06-18 [3] CRAN (R 3.6.3)                    
#>     rprojroot           2.0.2      2020-11-15 [3] CRAN (R 3.6.3)                    
#>     rstudioapi          0.13       2020-11-12 [3] CRAN (R 3.6.3)                    
#>     sandwich            3.0-1      2021-05-18 [3] CRAN (R 3.6.3)                    
#>     scales              1.1.1      2020-05-11 [3] CRAN (R 3.6.3)                    
#>     scatterplot3d       0.3-41     2018-03-14 [3] CRAN (R 3.5.0)                    
#>     seqinr              4.2-8      2021-06-09 [3] CRAN (R 3.6.3)                    
#>     sessioninfo         1.1.1      2018-11-05 [3] CRAN (R 3.5.1)                    
#>     sf                  1.0-0      2021-06-09 [3] CRAN (R 3.6.3)                    
#>     shiny               1.6.0      2021-01-25 [3] CRAN (R 3.6.3)                    
#>     sp                  1.4-5      2021-01-10 [3] CRAN (R 3.6.3)                    
#>     spData              0.3.8      2020-07-03 [3] CRAN (R 3.6.3)                    
#>     spdep               1.1-8      2021-05-23 [3] CRAN (R 3.6.3)                    
#>     stringi             1.7.3      2021-07-16 [1] CRAN (R 3.6.3)                    
#>     stringr             1.4.0      2019-02-10 [3] CRAN (R 3.5.2)                    
#>     survival            3.2-11     2021-04-26 [4] CRAN (R 3.6.3)                    
#>     SYNCSA              1.3.4      2020-01-09 [1] CRAN (R 3.6.3)                    
#>     TH.data             1.0-10     2019-01-21 [3] CRAN (R 3.5.2)                    
#>  VP tibble              3.1.2      2021-07-23 [3] CRAN (R 3.6.3)                    
#>     tictoc              1.0.1      2021-04-19 [3] CRAN (R 3.6.3)                    
#>     tidyr               1.1.3      2021-03-03 [3] CRAN (R 3.6.3)                    
#>     tidyselect          1.1.1      2021-04-30 [3] CRAN (R 3.6.3)                    
#>     tmvnsim             1.0-2      2016-12-15 [3] CRAN (R 3.6.3)                    
#>     units               0.7-2      2021-06-08 [3] CRAN (R 3.6.3)                    
#>  VP utf8                1.2.1      2021-07-24 [3] CRAN (R 3.6.3)                    
#>     uuid                0.1-4      2020-02-26 [3] CRAN (R 3.6.3)                    
#>     vctrs               0.3.8      2021-04-29 [3] CRAN (R 3.6.3)                    
#>     vegan               2.5-7      2020-11-28 [3] CRAN (R 3.6.3)                    
#>     withr               2.4.2      2021-04-18 [3] CRAN (R 3.6.3)                    
#>     xfun                0.24       2021-06-15 [1] CRAN (R 3.6.3)                    
#>     XML                 3.99-0.3   2020-01-20 [3] CRAN (R 3.6.3)                    
#>     xml2                1.3.2      2020-04-23 [3] CRAN (R 3.6.3)                    
#>     xtable              1.8-4      2019-04-21 [1] CRAN (R 3.6.3)                    
#>     yaml                2.2.1      2020-02-01 [3] CRAN (R 3.6.2)                    
#>     zoo                 1.8-9      2021-03-09 [3] CRAN (R 3.6.3)                    
#> 
#> [1] /homes/ke76dimu/R/x86_64-pc-linux-gnu-library/3.6
#> [2] /usr/local/lib/R/site-library
#> [3] /usr/lib/R/site-library
#> [4] /usr/lib/R/library
#> 
#>  V ── Loaded and on-disk version mismatch.
#>  P ── Loaded and on-disk path mismatch.
```

</details>

# References


